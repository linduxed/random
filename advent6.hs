import           Data.List (foldl')
import           Data.Set  (Set)
import qualified Data.Set  as S
import           Prelude

type Corner = (Int, Int)
type Transform = Set Int -> Set Int -> Set Int

lights :: Corner -> Corner -> Set Int
lights (a1, b1) (a2, b2) =
    S.fromList [a + 1000 * b
               | a <- [a1 .. a2]
               , b <- [b1 .. b2]]

turnOn :: Corner -> Corner -> Set Int -> Set Int
turnOn = transform S.union

turnOff :: Corner -> Corner -> Set Int -> Set Int
turnOff = transform (S.\\)

toggle :: Corner -> Corner -> Set Int -> Set Int
toggle from to s = (S.\\) (S.union s' s) intersection
    where
        intersection = S.intersection s s'
        s' = lights from to

transform :: Transform -> Corner -> Corner -> Set Int -> Set Int
transform f from to s = f s $ lights from to

main :: IO ()
main = putStrLn $ show count
    where
        count = S.size $ foldl' (\s f -> f s) S.empty actions

actions :: [Set Int -> Set Int]
actions = [ toggle (461,550) (564,900)
          , turnOff (370,39) (425,839)
          , turnOff (464,858) (833,915)
          , turnOff (812,389) (865,874)
          , turnOn (599,989) (806,993)
          , turnOn (376,415) (768,548)
          , turnOn (606,361) (892,600)
          , turnOff (448,208) (645,684)
          , toggle (50,472) (452,788)
          , toggle (205,417) (703,826)
          , toggle (533,331) (906,873)
          , toggle (857,493) (989,970)
          , turnOff (631,950) (894,975)
          , turnOff (387,19) (720,700)
          , turnOff (511,843) (581,945)
          , toggle (514,557) (662,883)
          , turnOff (269,809) (876,847)
          , turnOff (149,517) (716,777)
          , turnOff (994,939) (998,988)
          , toggle (467,662) (555,957)
          , turnOn (952,417) (954,845)
          , turnOn (565,226) (944,880)
          , turnOn (214,319) (805,722)
          , toggle (532,276) (636,847)
          , toggle (619,80) (689,507)
          , turnOn (390,706) (884,722)
          , toggle (17,634) (537,766)
          , toggle (706,440) (834,441)
          , toggle (318,207) (499,530)
          , toggle (698,185) (830,343)
          , toggle (566,679) (744,716)
          , toggle (347,482) (959,482)
          , toggle (39,799) (981,872)
          , turnOn (583,543) (846,710)
          , turnOff (367,664) (595,872)
          , turnOn (805,439) (964,995)
          , toggle (209,584) (513,802)
          , turnOff (106,497) (266,770)
          , turnOn (975,2) (984,623)
          , turnOff (316,684) (369,876)
          , turnOff (30,309) (259,554)
          , turnOff (399,680) (861,942)
          , toggle (227,740) (850,829)
          , turnOn (386,603) (552,879)
          , turnOff (703,795) (791,963)
          , turnOff (573,803) (996,878)
          , turnOff (993,939) (997,951)
          , turnOn (809,221) (869,723)
          , turnOff (38,720) (682,751)
          , turnOff (318,732) (720,976)
          , toggle (88,459) (392,654)
          , turnOff (865,654) (911,956)
          , toggle (264,284) (857,956)
          , turnOff (281,776) (610,797)
          , toggle (492,660) (647,910)
          , turnOff (879,703) (925,981)
          , turnOff (772,414) (974,518)
          , turnOn (694,41) (755,96)
          , turnOn (452,406) (885,881)
          , turnOff (107,905) (497,910)
          , turnOff (647,222) (910,532)
          , turnOn (679,40) (845,358)
          , turnOff (144,205) (556,362)
          , turnOn (871,804) (962,878)
          , turnOn (545,676) (545,929)
          , turnOff (316,716) (413,941)
          , toggle (488,826) (755,971)
          , toggle (957,832) (976,992)
          , toggle (857,770) (905,964)
          , toggle (319,198) (787,673)
          , turnOn (832,813) (863,844)
          , turnOn (818,296) (818,681)
          , turnOn (71,699) (91,960)
          , turnOff (838,578) (967,928)
          , toggle (440,856) (507,942)
          , toggle (121,970) (151,974)
          , toggle (391,192) (659,751)
          , turnOn (78,210) (681,419)
          , turnOn (324,591) (593,939)
          , toggle (159,366) (249,760)
          , turnOff (617,167) (954,601)
          , toggle (484,607) (733,657)
          , turnOn (587,96) (888,819)
          , turnOff (680,984) (941,991)
          , turnOn (800,512) (968,691)
          , turnOff (123,588) (853,603)
          , turnOn (1,862) (507,912)
          , turnOn (699,839) (973,878)
          , turnOff (848,89) (887,893)
          , toggle (344,353) (462,403)
          , turnOn (780,731) (841,760)
          , toggle (693,973) (847,984)
          , toggle (989,936) (996,958)
          , toggle (168,475) (206,963)
          , turnOn (742,683) (769,845)
          , toggle (768,116) (987,396)
          , turnOn (190,364) (617,526)
          , turnOff (470,266) (530,839)
          , toggle (122,497) (969,645)
          , turnOff (492,432) (827,790)
          , turnOn (505,636) (957,820)
          , turnOn (295,476) (698,958)
          , toggle (63,298) (202,396)
          , turnOn (157,315) (412,939)
          , turnOff (69,789) (134,837)
          , turnOff (678,335) (896,541)
          , toggle (140,516) (842,668)
          , turnOff (697,585) (712,668)
          , toggle (507,832) (578,949)
          , turnOn (678,279) (886,621)
          , toggle (449,744) (826,910)
          , turnOff (835,354) (921,741)
          , toggle (924,878) (985,952)
          , turnOn (666,503) (922,905)
          , turnOn (947,453) (961,587)
          , toggle (525,190) (795,654)
          , turnOff (62,320) (896,362)
          , turnOn (21,458) (972,536)
          , turnOn (446,429) (821,970)
          , toggle (376,423) (805,455)
          , toggle (494,896) (715,937)
          , turnOn (583,270) (667,482)
          , turnOff (183,468) (280,548)
          , toggle (623,289) (750,524)
          , turnOn (836,706) (967,768)
          , turnOn (419,569) (912,908)
          , turnOn (428,260) (660,433)
          , turnOff (683,627) (916,816)
          , turnOn (447,973) (866,980)
          , turnOn (688,607) (938,990)
          , turnOn (245,187) (597,405)
          , turnOff (558,843) (841,942)
          , turnOff (325,666) (713,834)
          , toggle (672,606) (814,935)
          , turnOff (161,812) (490,954)
          , turnOn (950,362) (985,898)
          , turnOn (143,22) (205,821)
          , turnOn (89,762) (607,790)
          , toggle (234,245) (827,303)
          , turnOn (65,599) (764,997)
          , turnOn (232,466) (965,695)
          , turnOn (739,122) (975,590)
          , turnOff (206,112) (940,558)
          , toggle (690,365) (988,552)
          , turnOn (907,438) (977,691)
          , turnOff (838,809) (944,869)
          , turnOn (222,12) (541,832)
          , toggle (337,66) (669,812)
          , turnOn (732,821) (897,912)
          , toggle (182,862) (638,996)
          , turnOn (955,808) (983,847)
          , toggle (346,227) (841,696)
          , turnOn (983,270) (989,756)
          , turnOff (874,849) (876,905)
          , turnOff (7,760) (678,795)
          , toggle (973,977) (995,983)
          , turnOff (911,961) (914,976)
          , turnOn (913,557) (952,722)
          , turnOff (607,933) (939,999)
          , turnOn (226,604) (517,622)
          , turnOff (3,564) (344,842)
          , toggle (340,578) (428,610)
          , turnOn (248,916) (687,925)
          , toggle (650,185) (955,965)
          , toggle (831,359) (933,536)
          , turnOff (544,614) (896,953)
          , toggle (648,939) (975,997)
          , turnOn (464,269) (710,521)
          , turnOff (643,149) (791,320)
          , turnOff (875,549) (972,643)
          , turnOff (953,969) (971,972)
          , turnOff (236,474) (772,591)
          , toggle (313,212) (489,723)
          , toggle (896,829) (897,837)
          , toggle (544,449) (995,905)
          , turnOff (278,645) (977,876)
          , turnOff (887,947) (946,977)
          , turnOn (342,861) (725,935)
          , turnOn (636,316) (692,513)
          , toggle (857,470) (950,528)
          , turnOff (736,196) (826,889)
          , turnOn (17,878) (850,987)
          , turnOn (142,968) (169,987)
          , turnOn (46,470) (912,853)
          , turnOn (182,252) (279,941)
          , toggle (261,143) (969,657)
          , turnOff (69,600) (518,710)
          , turnOn (372,379) (779,386)
          , toggle (867,391) (911,601)
          , turnOff (174,287) (900,536)
          , toggle (951,842) (993,963)
          , turnOff (626,733) (985,827)
          , toggle (622,70) (666,291)
          , turnOff (980,671) (985,835)
          , turnOff (477,63) (910,72)
          , turnOff (779,39) (940,142)
          , turnOn (986,570) (997,638)
          , toggle (842,805) (943,985)
          , turnOff (890,886) (976,927)
          , turnOff (893,172) (897,619)
          , turnOff (198,780) (835,826)
          , toggle (202,209) (219,291)
          , turnOff (193,52) (833,283)
          , toggle (414,427) (987,972)
          , turnOn (375,231) (668,236)
          , turnOff (646,598) (869,663)
          , toggle (271,462) (414,650)
          , turnOff (679,121) (845,467)
          , toggle (76,847) (504,904)
          , turnOff (15,617) (509,810)
          , toggle (248,105) (312,451)
          , turnOff (126,546) (922,879)
          , turnOn (531,831) (903,872)
          , toggle (602,431) (892,792)
          , turnOff (795,223) (892,623)
          , toggle (167,721) (533,929)
          , toggle (813,251) (998,484)
          , toggle (64,640) (752,942)
          , turnOn (155,955) (892,985)
          , turnOn (251,329) (996,497)
          , turnOff (341,716) (462,994)
          , toggle (760,127) (829,189)
          , turnOn (86,413) (408,518)
          , toggle (340,102) (918,558)
          , turnOff (441,642) (751,889)
          , turnOn (785,292) (845,325)
          , turnOff (123,389) (725,828)
          , turnOn (905,73) (983,270)
          , turnOff (807,86) (879,276)
          , toggle (500,866) (864,916)
          , turnOn (809,366) (828,534)
          , toggle (219,356) (720,617)
          , turnOff (320,964) (769,990)
          , turnOff (903,167) (936,631)
          , toggle (300,137) (333,693)
          , toggle (5,675) (755,848)
          , turnOff (852,235) (946,783)
          , toggle (355,556) (941,664)
          , turnOn (810,830) (867,891)
          , turnOff (509,869) (667,903)
          , toggle (769,400) (873,892)
          , turnOn (553,614) (810,729)
          , turnOn (179,873) (589,962)
          , turnOff (466,866) (768,926)
          , toggle (143,943) (465,984)
          , toggle (182,380) (569,552)
          , turnOff (735,808) (917,910)
          , turnOn (731,802) (910,847)
          , turnOff (522,74) (731,485)
          , turnOn (444,127) (566,996)
          , turnOff (232,962) (893,979)
          , turnOff (231,492) (790,976)
          , turnOn (874,567) (943,684)
          , toggle (911,840) (990,932)
          , toggle (547,895) (667,935)
          , turnOff (93,294) (648,636)
          , turnOff (190,902) (532,970)
          , turnOff (451,530) (704,613)
          , toggle (936,774) (937,775)
          , turnOff (116,843) (533,934)
          , turnOn (950,906) (986,993)
          , turnOn (910,51) (945,989)
          , turnOn (986,498) (994,945)
          , turnOff (125,324) (433,704)
          , turnOff (60,313) (75,728)
          , turnOn (899,494) (940,947)
          , toggle (832,316) (971,817)
          , toggle (994,983) (998,984)
          , toggle (23,353) (917,845)
          , toggle (174,799) (658,859)
          , turnOff (490,878) (534,887)
          , turnOff (623,963) (917,975)
          , toggle (721,333) (816,975)
          , toggle (589,687) (890,921)
          , turnOn (936,388) (948,560)
          , turnOff (485,17) (655,610)
          , turnOn (435,158) (689,495)
          , turnOn (192,934) (734,936)
          , turnOff (299,723) (622,847)
          , toggle (484,160) (812,942)
          , turnOff (245,754) (818,851)
          , turnOn (298,419) (824,634)
          , toggle (868,687) (969,760)
          , toggle (131,250) (685,426)
          , turnOff (201,954) (997,983)
          , turnOn (353,910) (832,961)
          , turnOff (518,781) (645,875)
          , turnOff (866,97) (924,784)
          , toggle (836,599) (857,767)
          , turnOn (80,957) (776,968)
          , toggle (277,130) (513,244)
          , turnOff (62,266) (854,434)
          , turnOn (792,764) (872,842)
          , turnOff (160,949) (273,989)
          , turnOff (664,203) (694,754)
          , toggle (491,615) (998,836)
          , turnOff (210,146) (221,482)
          , turnOff (209,780) (572,894)
          , turnOn (766,112) (792,868)
          , turnOn (222,12) (856,241)
          ]
